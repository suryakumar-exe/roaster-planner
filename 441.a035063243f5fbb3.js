"use strict";(self.webpackChunkroaster_planner=self.webpackChunkroaster_planner||[]).push([[441],{4441:(j,v,d)=>{d.r(v),d.d(v,{DashboardComponent:()=>M});var l=d(177),e=d(4438),m=d(5092),u=d(5602),h=d(7474),b=d(9478),F=d(4796);const g=(r,o,t)=>({"bg-secondary":r,"bg-success":o,"bg-danger":t}),R=(r,o,t)=>({"bg-warning":r,"bg-success":o,"bg-danger":t});function E(r,o){if(1&r&&(e.j41(0,"div",7)(1,"div",8)(2,"div",9)(3,"div")(4,"div",10),e.EFF(5),e.k0s(),e.j41(6,"div",11),e.EFF(7,"Team Members"),e.k0s()(),e.j41(8,"div",12),e.nrm(9,"i",32),e.k0s()()()()),2&r){const t=e.XpG();e.R7$(5),e.JRh(t.stats.teamMembersCount)}}function f(r,o){1&r&&(e.j41(0,"div",33),e.nrm(1,"i",34),e.j41(2,"p",35),e.EFF(3,"No recent rosters found"),e.k0s()())}function _(r,o){if(1&r&&(e.j41(0,"div",36)(1,"div")(2,"strong"),e.EFF(3),e.nI1(4,"date"),e.nI1(5,"date"),e.k0s(),e.j41(6,"div",37),e.EFF(7),e.k0s()(),e.j41(8,"span",38),e.EFF(9),e.k0s()()),2&r){const t=o.$implicit;e.R7$(3),e.Lme("",e.i5U(4,6,t.weekStartDate,"MMM dd")," - ",e.i5U(5,9,t.weekEndDate,"MMM dd"),""),e.R7$(4),e.Lme(" ",t.workFromOfficeDays.length," office days, ",t.workFromHomeDays.length," home days "),e.R7$(),e.Y8G("ngClass",e.sMw(12,g,"Draft"===t.status,"Submitted"===t.status,"Rejected"===t.status)),e.R7$(),e.JRh(t.status)}}function D(r,o){1&r&&(e.j41(0,"div",33),e.nrm(1,"i",39),e.j41(2,"p",35),e.EFF(3,"No recent leave requests"),e.k0s()())}function k(r,o){if(1&r&&(e.j41(0,"div",36)(1,"div")(2,"strong"),e.EFF(3),e.k0s(),e.j41(4,"div",37),e.EFF(5),e.nI1(6,"date"),e.nI1(7,"date"),e.k0s()(),e.j41(8,"span",38),e.EFF(9),e.k0s()()),2&r){const t=o.$implicit;e.R7$(3),e.JRh(t.leaveType),e.R7$(2),e.Lme(" ",e.i5U(6,5,t.startDate,"MMM dd")," - ",e.i5U(7,8,t.endDate,"MMM dd")," "),e.R7$(3),e.Y8G("ngClass",e.sMw(11,R,"Pending"===t.status,"Approved"===t.status,"Rejected"===t.status)),e.R7$(),e.JRh(t.status)}}let M=(()=>{class r{constructor(t,a,s,i,n){this.teamsService=t,this.usersService=a,this.rostersService=s,this.leavesService=i,this.authService=n,this.stats={totalUsers:0,totalTeams:0,totalRosters:0,totalLeaves:0,totalWFO:0,totalWFH:0,teamMembersCount:0},this.recentRosters=[],this.recentLeaves=[]}ngOnInit(){this.loadStats(),this.loadRecentData()}loadStats(){if(this.rostersService.getRosters().subscribe({next:t=>{const a=Array.isArray(t)?t:t.data||[],s=this.authService.getCurrentUser();if(s){const i=a.filter(n=>n.userId===s.id);this.stats.totalWFO=i.reduce((n,c)=>n+(c.workFromOfficeDays?.length||0),0),this.stats.totalWFH=i.reduce((n,c)=>n+(c.workFromHomeDays?.length||0),0),this.stats.totalLeaves=i.reduce((n,c)=>n+(c.leaveDays?.length||0),0),console.log("Dashboard stats loaded:",{totalWFO:this.stats.totalWFO,totalWFH:this.stats.totalWFH,totalLeaves:this.stats.totalLeaves,userRosters:i.length})}else this.stats.totalWFO=0,this.stats.totalWFH=0,this.stats.totalLeaves=0},error:t=>{console.error("Error loading roster statistics:",t),this.stats.totalWFO=0,this.stats.totalWFH=0,this.stats.totalLeaves=0}}),this.authService.isTeamLead()){const t=this.authService.getCurrentUser();t&&t.teamId?this.usersService.getUsers().subscribe({next:a=>{const s=Array.isArray(a)?a:a.data||[];this.stats.teamMembersCount=s.filter(i=>i.teamId===t.teamId&&"Employee"===i.role&&i.id!==t.id).length},error:a=>{console.error("Error loading team members count:",a),this.stats.teamMembersCount=0}}):this.stats.teamMembersCount=0}else this.stats.teamMembersCount=0}loadRecentData(){this.rostersService.getRosters().subscribe({next:t=>{const a=Array.isArray(t)?t:t.data||[],s=this.authService.getCurrentUser();if(s){const i=a.filter(n=>n.userId===s.id);this.recentRosters=i.sort((n,c)=>new Date(c.createdAt).getTime()-new Date(n.createdAt).getTime()).slice(0,5)}else this.recentRosters=[]},error:t=>{console.error("Error loading recent rosters:",t)}}),this.leavesService.getLeaves().subscribe({next:t=>{const a=Array.isArray(t)?t:t.data||[],s=this.authService.getCurrentUser();if(s){const i=a.filter(n=>n.userId===s.id);this.recentLeaves=i.sort((n,c)=>new Date(c.createdAt).getTime()-new Date(n.createdAt).getTime()).slice(0,5)}else this.recentLeaves=[]},error:t=>{console.error("Error loading recent leaves:",t)}})}static{this.\u0275fac=function(a){return new(a||r)(e.rXU(m.O),e.rXU(u.g),e.rXU(h.w),e.rXU(b.e),e.rXU(F.u))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-dashboard"]],standalone:!0,features:[e.aNF],decls:83,vars:11,consts:[[1,"container-fluid"],[1,"row","mb-4"],[1,"col-12"],[1,"card"],[1,"card-body"],[1,"card-title","mb-2"],[1,"card-text","text-muted"],[1,"col-xl-3","col-md-6","mb-4"],[1,"stats-card"],[1,"d-flex","justify-content-between","align-items-center"],[1,"stats-number"],[1,"stats-label"],[1,"fs-1","text-white-50"],[1,"bi","bi-building"],[1,"bi","bi-house"],[1,"bi","bi-calendar-event"],["class","col-xl-3 col-md-6 mb-4",4,"ngIf"],[1,"card-header"],[1,"card-title","mb-0"],[1,"row"],[1,"col-md-3","mb-3"],["routerLink","/roster",1,"btn","btn-outline-primary","w-100"],[1,"bi","bi-calendar3","me-2"],["routerLink","/leaves",1,"btn","btn-outline-success","w-100"],[1,"bi","bi-calendar-event","me-2"],["routerLink","/teams",1,"btn","btn-outline-info","w-100"],[1,"bi","bi-people","me-2"],["routerLink","/reports",1,"btn","btn-outline-warning","w-100"],[1,"bi","bi-graph-up","me-2"],[1,"col-md-6","mb-4"],["class","text-center text-muted py-4",4,"ngIf"],["class","d-flex justify-content-between align-items-center py-2 border-bottom",4,"ngFor","ngForOf"],[1,"bi","bi-people"],[1,"text-center","text-muted","py-4"],[1,"bi","bi-calendar3","fs-1"],[1,"mt-2"],[1,"d-flex","justify-content-between","align-items-center","py-2","border-bottom"],[1,"small","text-muted"],[1,"badge",3,"ngClass"],[1,"bi","bi-calendar-event","fs-1"]],template:function(a,s){if(1&a&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h2",5),e.EFF(6),e.nI1(7,"async"),e.k0s(),e.j41(8,"p",6),e.EFF(9,"Here's what's happening with your work schedule today."),e.k0s()()()()(),e.j41(10,"div",1)(11,"div",7)(12,"div",8)(13,"div",9)(14,"div")(15,"div",10),e.EFF(16),e.k0s(),e.j41(17,"div",11),e.EFF(18,"WFO Days"),e.k0s()(),e.j41(19,"div",12),e.nrm(20,"i",13),e.k0s()()()(),e.j41(21,"div",7)(22,"div",8)(23,"div",9)(24,"div")(25,"div",10),e.EFF(26),e.k0s(),e.j41(27,"div",11),e.EFF(28,"WFH Days"),e.k0s()(),e.j41(29,"div",12),e.nrm(30,"i",14),e.k0s()()()(),e.j41(31,"div",7)(32,"div",8)(33,"div",9)(34,"div")(35,"div",10),e.EFF(36),e.k0s(),e.j41(37,"div",11),e.EFF(38,"Leave Days"),e.k0s()(),e.j41(39,"div",12),e.nrm(40,"i",15),e.k0s()()()(),e.DNE(41,E,10,1,"div",16),e.k0s(),e.j41(42,"div",1)(43,"div",2)(44,"div",3)(45,"div",17)(46,"h5",18),e.EFF(47,"Quick Actions"),e.k0s()(),e.j41(48,"div",4)(49,"div",19)(50,"div",20)(51,"a",21),e.nrm(52,"i",22),e.EFF(53," Plan Roster "),e.k0s()(),e.j41(54,"div",20)(55,"a",23),e.nrm(56,"i",24),e.EFF(57," Request Leave "),e.k0s()(),e.j41(58,"div",20)(59,"a",25),e.nrm(60,"i",26),e.EFF(61," Manage Teams "),e.k0s()(),e.j41(62,"div",20)(63,"a",27),e.nrm(64,"i",28),e.EFF(65," View Reports "),e.k0s()()()()()()(),e.j41(66,"div",19)(67,"div",29)(68,"div",3)(69,"div",17)(70,"h5",18),e.EFF(71,"My Recent Rosters"),e.k0s()(),e.j41(72,"div",4),e.DNE(73,f,4,0,"div",30)(74,_,10,16,"div",31),e.k0s()()(),e.j41(75,"div",29)(76,"div",3)(77,"div",17)(78,"h5",18),e.EFF(79,"My Recent Leave Requests"),e.k0s()(),e.j41(80,"div",4),e.DNE(81,D,4,0,"div",30)(82,k,10,15,"div",31),e.k0s()()()()()),2&a){let i;e.R7$(6),e.SpI("Welcome back, ",null==(i=e.bMT(7,9,s.authService.currentUser$))?null:i.firstName,"!"),e.R7$(10),e.JRh(s.stats.totalWFO),e.R7$(10),e.JRh(s.stats.totalWFH),e.R7$(10),e.JRh(s.stats.totalLeaves),e.R7$(5),e.Y8G("ngIf",s.authService.isTeamLead()),e.R7$(32),e.Y8G("ngIf",0===s.recentRosters.length),e.R7$(),e.Y8G("ngForOf",s.recentRosters),e.R7$(7),e.Y8G("ngIf",0===s.recentLeaves.length),e.R7$(),e.Y8G("ngForOf",s.recentLeaves)}},dependencies:[l.MD,l.YU,l.Sq,l.bT,l.Jj,l.vh],encapsulation:2})}}return r})()}}]);